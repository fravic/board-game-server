# Migration `20200626215829-rename-player-add-action`

This migration has been generated by fravic at 6/26/2020, 9:58:29 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."Player" (
"gameId" TEXT NOT NULL  ,"id" TEXT NOT NULL  ,"name" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("gameId") REFERENCES "Game"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."Action" (
"actorId" TEXT   ,"gameId" TEXT NOT NULL  ,"id" TEXT NOT NULL  ,"payload" TEXT   ,"type" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("actorId") REFERENCES "Player"("id") ON DELETE SET NULL ON UPDATE CASCADE,
FOREIGN KEY ("gameId") REFERENCES "Game"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."new_Game" (
"id" TEXT NOT NULL  ,"name" TEXT NOT NULL  ,"numPlayers" INTEGER NOT NULL  ,
    PRIMARY KEY ("id"))

INSERT INTO "quaint"."new_Game" ("id", "name") SELECT "id", "name" FROM "quaint"."Game"

PRAGMA foreign_keys=off;
DROP TABLE "quaint"."Game";;
PRAGMA foreign_keys=on

ALTER TABLE "quaint"."new_Game" RENAME TO "Game";

PRAGMA foreign_keys=off;
DROP TABLE "quaint"."User";;
PRAGMA foreign_keys=on

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200623222646-init..20200626215829-rename-player-add-action
--- datamodel.dml
+++ datamodel.dml
@@ -1,19 +1,33 @@
 datasource db {
   provider = "sqlite"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
 }
-model User {
-  id    String  @id @default(uuid())
-  name  String
+model Player {
+  game    Game    @relation(fields: [gameId], references: [id])
+  gameId  String
+  id      String  @id @default(uuid())
+  name    String
 }
 model Game {
-  id    String  @id @default(uuid())
-  users User[]
-  name  String
-}
+  actions     Action[]
+  id          String    @id @default(uuid())
+  name        String
+  numPlayers  Int
+  players     Player[]
+}
+
+model Action {
+  actor   Player?   @relation(fields: [actorId], references: [id])
+  actorId String?
+  game    Game      @relation(fields: [gameId], references: [id])
+  gameId  String
+  id      String    @id @default(uuid())
+  payload String?
+  type    String
+}
```


